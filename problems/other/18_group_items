Convert the below input to the given output

Input â€”
name| item|weight
+â€” -+ â€” â€”- + â€” â€” -+
joe| mango| 2
kevin| kiwi| 2
joe|ğš‹ğšŠğš—ğšŠğš—ğšŠ| 2
joe| mango| 3
kevin| ğšğšŠğšŒğš˜| 2
kevin| kiwi| 2

Output â€”
Joe (mango,5), (banana, 2)
Kevin (kiwi,4), (taco, 2)

from pyspark.sql import SparkSession
from pyspark.sql.functions import *

spark = SparkSession.builder \
    .appName("CollectListRows") \
    .getOrCreate()
data = [
    ("joe", "mango", 2),
    ("kevin", "kiwi", 2),
    ("joe", "banana", 2),
    ("joe", "mango", 3),
    ("kevin", "taco", 2),
    ("kevin", "kiwi", 2)
]
schema = ['name', 'item', 'weight']
df = spark.createDataFrame(data=data, schema=schema)
df_final = df.groupBy("name", "item").agg(sum("weight").alias("total_weight"))
df_final = df_final.groupBy("name").agg(collect_list(struct('item', "total_weight")).alias("total_items"))
df_final.show()
